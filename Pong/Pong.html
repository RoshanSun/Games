<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Roshan's Pong Game</title>
    <style>
      * { padding: 0; margin: 0; }
      canvas { background: #000; display: block; margin: 0 auto; }
    </style>
</head>
<body>
  <canvas id="myCanvas" width="800" height="600"></canvas>
  <script>
    var canvas = document.getElementById("myCanvas");
    var context = canvas.getContext("2d");
    var x = canvas.width / 2;
    var y = canvas.height / 2;
    var radius = 10;
    var dx = Math.floor(Math.random() * 10 - 5);
    var dy = Math.floor(Math.random() * 10 - 5);
    var paddleWidth = 10;
    var paddleHeight = 75;
    var paddleOffset = 10;
    var paddleYOne = (canvas.height - paddleHeight) / 2; 
    var paddleYTwo = (canvas.height - paddleHeight) / 2;
    var scoreOne = 0;
    var scoreTwo = 0;
    var playerOneUpPressed = false;
    var playerOneDownPressed = false;
    var playerTwoUpPressed = false;
    var playerTwoDownPressed = false;

    function draw() {
      context.clearRect(0, 0, canvas.width, canvas.height);
      drawBall();
      drawPlayerOnePaddle();
      drawPlayerTwoPaddle();
      drawPlayerOneScore();
      drawPlayerTwoScore();
      borderControl();
      paddleCollision();
      pointsControl();
      paddleSpeedControl();
      x += dx;
      y += dy;
    }

    function drawBall() {
      context.beginPath();
      context.arc(x, y, radius, 0, Math.PI*2);
      context.fillStyle = "#FFF";
      context.fill();
      context.closePath();
    }

    function drawPlayerOnePaddle() {
      context.beginPath();
      context.rect(paddleOffset, paddleYOne, paddleWidth, paddleHeight);
      context.fillStyle = "#FFF";
      context.fill();
      context.closePath();
    }

    function drawPlayerTwoPaddle() {
      context.beginPath();
      context.rect(canvas.width - paddleOffset - paddleWidth, paddleYTwo, paddleWidth, paddleHeight);
      context.fillStyle = "#FFF";
      context.fill();
      context.closePath();
    }

    // Keep track of player's score
    function drawPlayerOneScore() {
      context.font = "16px Arial";
      context.fillStyle = "#FFF";
      context.fillText("P1: " + scoreOne, 22, 20);
    }

    // Keep track of player's lives
    function drawPlayerTwoScore() {
      context.font = "16px Arial";
      context.fillStyle = "#FFF";
      context.fillText("P2: " + scoreTwo, canvas.width - 60, 20);
    }

    function borderControl() {
      if(y + dy < radius ||
         y + dy > canvas.height - radius) {
        dy = -dy;
      }
    }

    function pointsControl() {
      if(x + dx < radius) {
        scoreTwo++;
        resetBoard();
      } else if(x + dx > canvas.width - radius) {
        scoreOne++;
        resetBoard();
      }
    }

    function paddleSpeedControl() {
      if(playerOneDownPressed && paddleYOne < canvas.height - paddleHeight) {
        paddleYOne += 7;
      } else if(playerOneUpPressed && paddleYOne > 0) {
        paddleYOne -= 7;
      } 

      if(playerTwoDownPressed && paddleYTwo < canvas.height - paddleHeight) {
        paddleYTwo += 7;
      } else if(playerTwoUpPressed && paddleYTwo > 0) {
        paddleYTwo -= 7;
      }
    }

    function paddleCollision() {
      if(x + dx < radius + paddleOffset) {
        if(y > paddleYOne && y < paddleYOne + paddleHeight) {
          dx = -dx;
        }
      } else if(x + dx > canvas.width - radius - paddleOffset) {
        if(y > paddleYTwo && y < paddleYTwo + paddleHeight) {
          dx = -dx;
        }
      }
    }

    function resetBoard() {
      x = canvas.width / 2;
      y = canvas.height / 2;
      dx = Math.floor(Math.random() * 10 - 5);
      dy = Math.floor(Math.random() * 10 - 5);
    }

    function keyDownHandler(e) {
      if(e.keyCode == 38) {
        playerTwoUpPressed = true;
      } else if(e.keyCode == 40) {
        playerTwoDownPressed = true;
      }

      if(e.keyCode == 87) {
        playerOneUpPressed = true;
      } else if(e.keyCode == 83) {
        playerOneDownPressed = true;
      }
    }

    // Detect when left/right keys are released
    function keyUpHandler(e) {
      if(e.keyCode == 38) {
        playerTwoUpPressed = false;
      } else if(e.keyCode == 40) {
        playerTwoDownPressed = false;
      }

      if(e.keyCode == 87) {
        playerOneUpPressed = false;
      } else if(e.keyCode == 83) {
        playerOneDownPressed = false;
      }
    }

    // Track keyboard and mouse movement
    document.addEventListener("keydown", keyDownHandler, false);
    document.addEventListener("keyup", keyUpHandler, false);

    setInterval(draw, 10);
  </script>
</body>
</html>