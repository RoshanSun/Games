<!--
Roshan's Snake Game
Version 1.0
Last edited on: June 13, 2018
------------------------------->

<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
    <title>Roshan's Snake Game</title>
    <style>
      * { padding: 0; margin: 0; }
      canvas { background: #000; display: block; margin: 0 auto; }
    </style>
</head>
<body>
	<canvas id="myCanvas" width="600" height="600"></canvas>
	<script>
		var canvas = document.getElementById("myCanvas");
    var context = canvas.getContext("2d");
    var pixelSize = 10;
    var numRows = canvas.height/pixelSize;
    var numCols = canvas.width/pixelSize;
    var x = canvas.width/2;
    var y = canvas.height/2;
    var total = 0;
    var snakeTail = [];
    var dx = 1;
    var dy = 0;
    var foodX = Math.floor((Math.random() * numCols)) * pixelSize;
    var foodY = Math.floor((Math.random() * numRows)) * pixelSize;

    function draw() {
      context.clearRect(0, 0, canvas.width, canvas.height);
      drawSnake();
      drawFood();
      // update();
      hasEaten(foodX, foodY);
      borderCollision();
      x += dx * pixelSize;
      y += dy * pixelSize;
    }

    function drawSnake() {
      context.beginPath();
      context.rect(x, y, pixelSize, pixelSize);
      context.fillStyle = "#FFF";
      context.fill();
      context.closePath();
    }

    function drawFood() {
      context.beginPath();
      context.rect(foodX, foodY, pixelSize, pixelSize);
      context.fillStyle = "#FF0";
      context.fill();
      context.closePath();
    }

    function directionController(xSpeed, ySpeed) {
      if(xSpeed != dx*-1 && ySpeed != dy*-1) {
        dx = xSpeed;
        dy = ySpeed;
      }
    }

    function hasEaten(currFoodX, currFoodY) {
      var distance = getDistance(x, y, currFoodX, currFoodY);
      if(distance < 1) {
        foodX = Math.floor((Math.random() * numCols)) * pixelSize;
        foodY = Math.floor((Math.random() * numRows)) * pixelSize;
        total++;
      }
    }

    function getDistance(snakeX, snakeY, currFoodX, currFoodY) {
      var xDist = snakeX - currFoodX;
      var yDist = snakeY - currFoodY;
      var totalDistance = Math.sqrt(Math.pow(xDist, 2) + Math.pow(yDist, 2));
      return totalDistance;
    }

    function borderCollision() {
      if(x < 0 ||
         y < 0 ||
         x > canvas.width - pixelSize ||
         y > canvas.height - pixelSize) {
        resetGame();
      }
    }

    function resetGame() {
      x = canvas.width/2;
      y = canvas.height/2;
      foodX = Math.floor((Math.random() * numCols)) * pixelSize;
      foodY = Math.floor((Math.random() * numRows)) * pixelSize;
      dx = 1;
      dy = 0;
    }

    function update() {
      if (total === snakeTail.length) {
        for(var i = 0; i < snakeTail.length-1; i++) {
          snakeTail[i] = snakeTail[i+1];
        }
      }
      snakeTail[total-1] = { xCoord: x, yCoord: y};

      xCoord = xCoord + dx * pixelSize;
      yCoord = yCoord + dy * pixelSize;
    }

    document.addEventListener("keydown", keyPressed, false);

    function keyPressed(e) {
      if(e.keyCode == 38) {
        directionController(0, -1);
      } else if(e.keyCode === 40) {
        directionController(0, 1);
      } else if(e.keyCode === 37) {
        directionController(-1, 0);
      } else if(e.keyCode === 39) {
        directionController(1, 0);
      }
    }

    setInterval(draw, 100);
	</script>

</body>
</html>